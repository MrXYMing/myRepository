# 第9章 客户端检测

### 9.1能力检测

在编写代码之前先检测特定浏览器的能力。例如脚本在调用某个函数之前，可能要先检测该函数是否存在。开发人员只需知道相应的能力是否存在，而不必考虑具体的浏览器类型和版本。

### 9.2怪癖检测

怪癖实际上是浏览器实现中存在的bug，例如早期的Webkit中就存在一个怪癖，即它会在for-in循环中返回被隐藏的属性。怪癖检测通常涉及到运行一小段代码，然后确定浏览器是否存在某个怪癖。因其效率比能力检测更低，因此应该只在某个怪癖会干扰脚本运行的情况下使用。

### 9.3 用户代理检测

用户代理检测通过检测用户代理字符串来确定实际使用的浏览器。用户代理字符串中包含大量与浏览器有关的信息，包括浏览器、平台、操作系统以及浏览器版本呢。在每一次HTTP请求过程中，用户代理字符串是作为响应首部发送的，而且该字符串可以通过js的navigator.userAgent属性访问。

`电子欺骗`：指浏览器通过在自己的用户代理字符串加入一些错误或误导性信息，来达到欺骗服务器的目的。

#### 9.3.1 用户代理字符串的历史

HTTP规范明确规定，浏览器应该发送简短的用户代理字符串，指明浏览器的名称和版本号。

#### 9.3.2 用户代理字符串检测技术

1. 识别呈现引擎；
2. 识别浏览器；
3. 识别平台；
4. 识别Windows操作系统；
5. 识别移动设备；
6. 识别游戏系统。

*具体实现代码待补充*

